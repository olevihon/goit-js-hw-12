{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/helpers.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '28832278-63978a27bea5cce988fdacee8';\n\naxios.defaults.baseURL = 'https://pixabay.com/';\n\nexport const PER_PAGE = 15;\n\nexport const fetchPhotos = async (query, pageNumber = 1) => {\n  const response = await axios.get('api/', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: PER_PAGE,\n      page: pageNumber,\n    },\n  });\n\n  return response.data;\n};\n","export const createGalleryItemMarkup = images => {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <li class=\"gallery-item js-gallery-item\">\n        <a class=\"gallery-link js-gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" >\n        </a>\n        <div class=\"gallery-info\">\n            <div class=\"gallery-info-item\">\n                <div class=\"gallery-info-title\">Likes</div>\n                <div class=\"gallery-info-value\">${likes}</div>\n            </div>\n            <div class=\"gallery-info-item\">\n                <div class=\"gallery-info-title\">Views</div>\n                <div class=\"gallery-info-value\">${views}</div>\n            </div>\n            <div class=\"gallery-info-item\">\n                <div class=\"gallery-info-title\">Comments</div>\n                <div class=\"gallery-info-value\">${comments}</div>\n            </div>\n            <div class=\"gallery-info-item\">\n                <div class=\"gallery-info-title\">Downloads</div>\n                <div class=\"gallery-info-value\">${downloads}</div>\n            </div>\n        </div>   \n    </li>`\n    )\n    .join('');\n};\n","export const hideEl = el => {\n  el.classList.add('is-hidden');\n};\n\nexport const showEl = el => {\n  el.classList.remove('is-hidden');\n};\n\nexport const setDisabled = el => {\n  el.disabled = true;\n};\n\nexport const unsetDisabled = el => {\n  el.disabled = false;\n};\n\nexport const clearElInnerHtml = el => {\n  el.innerHTML = '';\n};\n","// https://izitoast.marcelodolza.com/\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// https://simplelightbox.com/\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchPhotos, PER_PAGE } from './js/pixabay-api';\nimport { createGalleryItemMarkup } from './js/render-functions';\nimport {\n  hideEl,\n  showEl,\n  setDisabled,\n  unsetDisabled,\n  clearElInnerHtml,\n} from './js/helpers';\n\nconst galleryEl = document.querySelector('.js-gallery');\nconst formSearchEl = document.querySelector('.js-form-search');\nconst loaderEl = document.querySelector('.js-loader');\nconst btnMoreEl = document.querySelector('.js-btn-more');\nconst endMsgEl = document.querySelector('.js-end-msg');\n\nconst toastCommonOpts = {\n  position: 'topRight',\n  transitionIn: 'fadeIn',\n  transitionOut: 'fadeOut',\n  animateInside: false,\n};\n\nconst lightbox = new SimpleLightbox('.js-gallery .js-gallery-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nlet searchQuery = '';\nlet currentPage = 1;\nlet totalPages = 0;\nlet lastGalleryItemEl = null;\n\nconst setLastGalleryItemEL = () => {\n  lastGalleryItemEl = galleryEl.querySelector('.js-gallery-item:last-child');\n};\n\nconst onSearch = async event => {\n  event.preventDefault();\n\n  // Define form and submit button elements\n  const form = event.currentTarget;\n  const submitBtnEl = form.querySelector('.js-btn-submit');\n\n  // Get search query from input\n  searchQuery = form.elements.searchKeyword.value.trim();\n\n  // Handle empty query\n  if (searchQuery === '') {\n    iziToast.error({\n      message: 'Please enter search query',\n      ...toastCommonOpts,\n    });\n    return;\n  }\n\n  // Clear gallery html\n  clearElInnerHtml(galleryEl);\n\n  // Hide load more btn\n  hideEl(btnMoreEl);\n\n  // Hide end gallery items message\n  hideEl(endMsgEl);\n\n  try {\n    // Disabled submit btn\n    setDisabled(submitBtnEl);\n\n    // Show loader\n    showEl(loaderEl);\n\n    // Set current page to for each new search\n    currentPage = 1;\n\n    // Get gallery items\n    const { hits, totalHits } = await fetchPhotos(searchQuery, currentPage);\n\n    // Handle not found query or hits array is empty\n    if (totalHits === 0 || hits.length === 0) {\n      // Enable search btn\n      unsetDisabled(submitBtnEl);\n\n      // Show error message\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        ...toastCommonOpts,\n      });\n\n      // Hide loader\n      hideEl(loaderEl);\n\n      // Reset form\n      form.reset();\n\n      // Stop func evaluation here\n      return;\n    }\n\n    // Hide loader\n    hideEl(loaderEl);\n\n    // Add gallery items on page\n    galleryEl.innerHTML = createGalleryItemMarkup(hits);\n\n    // Set last gallery item element ( will be need later for load more btn )\n    setLastGalleryItemEL();\n\n    // Refresh lightbox\n    lightbox.refresh();\n\n    // Reset form\n    form.reset();\n\n    // Hide loader\n    hideEl(loaderEl);\n\n    // Enable search btn\n    unsetDisabled(submitBtnEl);\n\n    // Handle show more btn\n    totalPages = Math.ceil(totalHits / PER_PAGE);\n    if (totalPages > 1) {\n      showEl(btnMoreEl);\n      btnMoreEl.addEventListener('click', onBtnMoreClick);\n    }\n  } catch (error) {\n    // Enable search btn\n    unsetDisabled(submitBtnEl);\n\n    // Hide loader\n    hideEl(loaderEl);\n\n    // Show error message\n    iziToast.error({\n      message: error.message,\n      ...toastCommonOpts,\n    });\n  }\n};\n\nconst onBtnMoreClick = async event => {\n  try {\n    currentPage += 1;\n\n    // Hide btn more\n    hideEl(btnMoreEl);\n\n    // Show loader\n    showEl(loaderEl);\n\n    // Get gallery items\n    const { hits, totalHits } = await fetchPhotos(searchQuery, currentPage);\n\n    // Hide loader\n    hideEl(loaderEl);\n\n    // Add gallery items on page\n    galleryEl.insertAdjacentHTML('beforeend', createGalleryItemMarkup(hits));\n\n    // Refresh lightbox\n    lightbox.refresh();\n\n    // Scroll to new added items\n    window.scrollBy({\n      top: lastGalleryItemEl.getBoundingClientRect().bottom,\n      left: 0,\n      behavior: 'smooth',\n    });\n\n    // Set last gallery item ( must be after scroll )\n    setLastGalleryItemEL();\n\n    // Handle btn more\n    totalPages = Math.ceil(totalHits / PER_PAGE);\n    if (currentPage < totalPages) {\n      showEl(btnMoreEl);\n    } else {\n      btnMoreEl.removeEventListener('click', onBtnMoreClick);\n      showEl(endMsgEl);\n    }\n  } catch (error) {\n    // Hide loader\n    hideEl(loaderEl);\n\n    // Show error message\n    iziToast.error({\n      message: error.message,\n      ...toastCommonOpts,\n    });\n  }\n};\n\nformSearchEl.addEventListener('submit', onSearch);\n"],"names":["API_KEY","axios","PER_PAGE","fetchPhotos","query","pageNumber","createGalleryItemMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","hideEl","el","showEl","setDisabled","unsetDisabled","clearElInnerHtml","galleryEl","formSearchEl","loaderEl","btnMoreEl","endMsgEl","toastCommonOpts","lightbox","SimpleLightbox","searchQuery","currentPage","totalPages","lastGalleryItemEl","setLastGalleryItemEL","onSearch","event","form","submitBtnEl","iziToast","hits","totalHits","onBtnMoreClick","error"],"mappings":"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"}